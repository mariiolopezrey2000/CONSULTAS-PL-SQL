1-
SELECT DEPT_NO,OFICIO,COUNT(*) 
FROM EMPLE GROUP BY DEPT_NO,OFICIO 
HAVING OFICIO ='EMPLEADO' AND COUNT(*)=
(SELECT MAX(COUNT(*)) 
FROM EMPLE GROUP BY DEPT_NO,OFICIO 
HAVING OFICIO ='EMPLEADO')
;  

START C:\TABLAS\TABLAS.SQL
2-
SELECT NOMBRE_BANC FROM BANCOS WHERE COD_BANCO IN
(SELECT COD_BANCO FROM CUENTAS 
GROUP BY COD_BANCO HAVING COUNT(*)=(SELECT MAX(COUNT(*)) FROM CUENTAS 
GROUP BY COD_BANCO));

-- 3-
SELECT PROV_SUC ,COUNT(*) FROM SUCURSALES
GROUP BY PROV_SUC HAVING COUNT(*)=(SELECT MAX(COUNT(*))FROM SUCURSALES
GROUP BY PROV_SUC )
;

4-
SELECT * FROM ALUM WHERE (NOMBRE,EDAD,LOCALIDAD) 
IN (SELECT * FROM NUEVOS ) AND (NOMBRE,EDAD,LOCALIDAD) 
NOT IN (SELECT * FROM ANTIGUOS)

5-
INSERT INTO PROFESORES (COD_CENTRO,DNI,APELLIDOS,ESPECIALIDAD)
SELECT C.COD_CENTRO,2342345,'MARIO LOPEZ REY','INFORMATICA' 
FROM CENTROS C
WHERE 
C.COD_CENTRO = (SELECT C.COD_CENTRO
FROM PROFESORES P,CENTROS C
WHERE P.COD_CENTRO(+)=C.COD_CENTRO
GROUP BY C.COD_CENTRO HAVING COUNT(DNI)=
(SELECT MIN(COUNT(DNI)) 
FROM PROFESORES P,CENTROS C
WHERE P.COD_CENTRO(+)=C.COD_CENTRO
GROUP BY C.COD_CENTRO));


6-
DELETE FROM CENTROS C
WHERE C.COD_CENTRO NOT IN 
(SELECT  DISTINCT PE.COD_CENTRO FROM PERSONAL PE) AND C.COD_CENTRO
NOT IN (SELECT  DISTINCT COD_CENTRO FROM PROFESORES P)


7-
UPDATE ARTICULOS
SET CATEGORIA='TERCERA'
WHERE CATEGORIA='Segunda' AND
(ARTICULO,COD_FABRICANTE,PESO,CATEGORIA) IN(SELECT ARTICULO,COD_FABRICANTE,PESO,CATEGORIA 
FROM ARTICULOS 
GROUP BY ARTICULO,COD_FABRICANTE,PESO,CATEGORIA 
HAVING COD_FABRICANTE IN
(SELECT COD_FABRICANTE FROM FABRICANTES WHERE PAIS='ITALIA'));

8-

SELECT PROVINCIA,SUM(PRECIO_VENTA*UNIDADES_VENDIDAS)
FROM TIENDAS T,VENTAS V,ARTICULOS A
WHERE A.ARTICULO=V.ARTICULO AND
A.COD_FABRICANTE=V.COD_FABRICANTE AND
A.PESO=V.PESO AND
A.CATEGORIA=V.CATEGORIA AND
V.NIF=T.NIF
GROUP BY PROVINCIA;


9-
SELECT A.ARTICULO,A.COD_FABRICANTE,A.PESO,A.CATEGORIA,COUNT(UNIDADES_PEDIDAS)
FROM PEDIDOS P,ARTICULOS A
WHERE P.ARTICULO(+) =A.ARTICULO AND
P.COD_FABRICANTE(+)=A.COD_FABRICANTE AND
P.PESO(+)=A.PESO AND
P.CATEGORIA(+)=A.CATEGORIA  GROUP BY
A.ARTICULO,A.COD_FABRICANTE,A.PESO,A.CATEGORIA;


